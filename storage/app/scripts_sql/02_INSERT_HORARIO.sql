INSERT INTO nexti.dbo.FLEX_HORARIO
SELECT 
'1' AS NUMEMP,
'01' AS CODFIL,
'' AS CODHOR,
REPLACE(IIF(CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_ENTRA1) AS INT)) = 0, '00', CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_ENTRA1) AS INT))) + ':' +
IIF(RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_ENTRA1 * 100, 0) AS INT)), 2) = 0, '00', RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_ENTRA1 * 100, 0) AS INT)), 2)) + ' as ' +
IIF(CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_SAIDA1) AS INT)) = 0, '00', CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_SAIDA1) AS INT))) + ':' +
IIF(RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_SAIDA1 * 100, 0) AS INT)), 2) = 0, '00', RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_SAIDA1 * 100, 0) AS INT)), 2)) + ' / ' +
IIF(CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_ENTRA2) AS INT)) = 0, '00', CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_ENTRA2) AS INT))) + ':' +
IIF(RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_ENTRA2 * 100, 0) AS INT)), 2) = 0, '00', RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_ENTRA2 * 100, 0) AS INT)), 2)) + ' as ' +
IIF(CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_SAIDA2) AS INT)) = 0, '00', CONVERT(VARCHAR(5), CAST(FLOOR(SPJ010.PJ_SAIDA2) AS INT))) + ':' +
IIF(RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_SAIDA2 * 100, 0) AS INT)), 2) = 0, '00', RIGHT(CONVERT(VARCHAR(4), CAST(ROUND(SPJ010.PJ_SAIDA2 * 100, 0) AS INT)), 2)), '.', ':') AS DESHOR,  
SPJ010.PJ_ENTRA1 AS ENTRADA1,
SPJ010.PJ_SAIDA1 AS SAIDA1,
SPJ010.PJ_ENTRA2 AS ENTRADA2,
SPJ010.PJ_SAIDA2 AS SAIDA2,                                       
0 AS ID,
'' AS IDEXTERNO,
0 AS TIPO,
0 AS SITUACAO,
'' AS OBSERVACAO
FROM ALIANCA.dbo.SPJ010
JOIN nexti.dbo.FLEX_EMPRESA
	ON nexti.dbo.FLEX_EMPRESA.NUMEMP = '1'
WHERE NOT EXISTS(
	SELECT * FROM nexti.dbo.FLEX_HORARIO
	WHERE nexti.dbo.FLEX_HORARIO.ENTRADA1 = SPJ010.PJ_ENTRA1
	AND nexti.dbo.FLEX_HORARIO.SAIDA1 = SPJ010.PJ_SAIDA1
	AND nexti.dbo.FLEX_HORARIO.ENTRADA2 = SPJ010.PJ_ENTRA2
	AND nexti.dbo.FLEX_HORARIO.SAIDA2 = SPJ010.PJ_SAIDA2
)
AND SPJ010.D_E_L_E_T_ = ''
GROUP BY 
SPJ010.PJ_ENTRA1,
SPJ010.PJ_SAIDA1,
SPJ010.PJ_ENTRA2,
SPJ010.PJ_SAIDA2