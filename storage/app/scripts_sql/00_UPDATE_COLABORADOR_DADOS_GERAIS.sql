UPDATE nexti.dbo.FLEX_COLABORADOR
SET
nexti.dbo.FLEX_COLABORADOR.CEP = SRA010.RA_CEP,
nexti.dbo.FLEX_COLABORADOR.NOMFUN = LTRIM(RTRIM(SRA010.RA_NOME)),
nexti.dbo.FLEX_COLABORADOR.ENDERECO = RTRIM(RA_ENDEREC),
nexti.dbo.FLEX_COLABORADOR.COMPLEMENTO= RTRIM(RA_COMPLEM),
nexti.dbo.FLEX_COLABORADOR.NUMERO = RTRIM(RA_NUMENDE),
nexti.dbo.FLEX_COLABORADOR.BAIRRO = RTRIM(RA_BAIRRO),
nexti.dbo.FLEX_COLABORADOR.CIDADE = (RA_MUNICIP),
nexti.dbo.FLEX_COLABORADOR.ESTADO = RTRIM(RA_ESTADO),
nexti.dbo.FLEX_COLABORADOR.DATADMISSAO = RA_ADMISSA,
nexti.dbo.FLEX_COLABORADOR.DATANASCIMENTO = SRA010.RA_NASC,
nexti.dbo.FLEX_COLABORADOR.CARGO = nexti.dbo.FLEX_CARGO.IDEXTERNO,
nexti.dbo.FLEX_COLABORADOR.CPF = RTRIM(SRA010.RA_CIC),
nexti.dbo.FLEX_COLABORADOR.RG = RTRIM(SRA010.RA_RG),
nexti.dbo.FLEX_COLABORADOR.PIS = RTRIM(SRA010.RA_PIS),
nexti.dbo.FLEX_COLABORADOR.GENERO = SRA010.RA_SEXO,
nexti.dbo.FLEX_COLABORADOR.EMAIL = RTRIM(SRA010.RA_EMAIL),
nexti.dbo.FLEX_COLABORADOR.TELEFONE = RTRIM(SRA010.RA_TELEFON),
nexti.dbo.FLEX_COLABORADOR.TELEFONE2 = (CAST(RTRIM(SRA010.RA_DDDCELU) AS VARCHAR(100)) + CAST(RTRIM(SRA010.RA_NUMCELU) AS VARCHAR(100))),
nexti.dbo.FLEX_COLABORADOR.NOME_PAI = RTRIM(SRA010.RA_PAI),
nexti.dbo.FLEX_COLABORADOR.NOME_MAE = RTRIM(SRA010.RA_MAE),
nexti.dbo.FLEX_COLABORADOR.TIPO = 1,
nexti.dbo.FLEX_COLABORADOR.SITUACAO = 0
FROM nexti.dbo.FLEX_COLABORADOR
JOIN ALIANCA.dbo.SRA010 SRA010
	ON nexti.dbo.FLEX_COLABORADOR.NUMCAD = SRA010.RA_MAT collate database_default
	AND nexti.dbo.FLEX_COLABORADOR.CODFIL = SRA010.RA_FILIAL collate database_default
	AND nexti.dbo.FLEX_COLABORADOR.NUMEMP = LEFT(SRA010.RA_FILIAL,2)
	AND LTRIM(RTRIM(SRA010.RA_DEMISSA)) = ''
	AND SRA010.D_E_L_E_T_ <> '*'
JOIN nexti.dbo.FLEX_CARGO
    ON nexti.dbo.FLEX_CARGO.CODCAR = SRA010.RA_CODFUNC collate database_default
    AND nexti.dbo.FLEX_CARGO.CODFIL = LEFT(SRA010.RA_FILIAL,2) collate database_default
WHERE nexti.dbo.FLEX_COLABORADOR.ID > 0
AND (
	nexti.dbo.FLEX_COLABORADOR.CEP <> SRA010.RA_CEP collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.NOMFUN <> LTRIM(RTRIM(SRA010.RA_NOME)) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.ENDERECO <> RTRIM(RA_ENDEREC) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.COMPLEMENTO<> RTRIM(RA_COMPLEM) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.NUMERO <> RTRIM(RA_NUMENDE) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.BAIRRO <> RTRIM(RA_BAIRRO) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.CIDADE <> (RA_MUNICIP) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.ESTADO <> RTRIM(RA_ESTADO) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.DATADMISSAO <> RA_ADMISSA collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.DATANASCIMENTO <> SRA010.RA_NASC collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.CARGO <> nexti.dbo.FLEX_CARGO.IDEXTERNO collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.CPF <> RTRIM(SRA010.RA_CIC) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.RG <> RTRIM(SRA010.RA_RG) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.PIS <> RTRIM(SRA010.RA_PIS) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.GENERO <> SRA010.RA_SEXO collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.EMAIL <> RTRIM(SRA010.RA_EMAIL) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.TELEFONE <> RTRIM(SRA010.RA_TELEFON) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.TELEFONE2 <> (CAST(RTRIM(SRA010.RA_DDDCELU) AS VARCHAR(100)) + CAST(RTRIM(SRA010.RA_NUMCELU) AS VARCHAR(100))) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.NOME_PAI <> RTRIM(SRA010.RA_PAI) collate database_default
	OR nexti.dbo.FLEX_COLABORADOR.NOME_MAE <> RTRIM(SRA010.RA_MAE) collate database_default
)